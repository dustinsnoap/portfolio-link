const canvas = document.getElementById('link')
const ctx = canvas.getContext('2d')

const link = {
	size: 16,
	cords: {x: 50, y: 50},
	colors: ['#80d010', '#fc9838', '#c84c0c'],
	frames: {
		walk_down: [[0,0,0,0,0,1,1,1,1,1,1,0,0,0,0,0,
								 0,0,0,0,1,1,1,1,1,1,1,1,0,0,0,0,
								 0,0,2,0,1,3,3,3,3,3,3,1,0,2,0,0,
								 0,0,2,0,3,3,3,3,3,3,3,3,0,2,0,0,
								 0,0,2,2,3,2,1,2,2,1,2,3,2,2,0,0,
								 0,0,2,2,3,2,3,2,2,3,2,3,2,2,0,0,
								 0,0,0,2,2,2,2,2,2,2,2,2,2,3,0,0,
								 0,0,0,1,1,2,2,3,3,2,2,1,1,3,0,0,
								 0,3,3,3,3,3,2,2,2,2,1,1,3,3,3,0,
								 3,3,2,3,3,3,3,1,1,1,1,1,2,3,3,0,
								 3,2,2,2,3,3,2,3,3,1,1,2,2,2,3,0,
								 3,3,2,3,3,3,2,1,3,3,3,3,2,2,2,0,
								 3,3,2,3,3,3,2,3,3,1,1,1,1,2,0,0,
								 3,3,3,3,3,3,2,1,1,1,1,1,0,0,0,0,
								 0,2,2,2,2,2,3,0,0,3,3,3,0,0,0,0,
								 0,0,0,0,3,3,3,0,0,0,0,0,0,0,0,0],
							 [ 0,0,0,0,0,1,1,1,1,1,1,0,0,0,0,0,
								 0,0,0,0,1,1,1,1,1,1,1,1,0,0,0,0,
								 0,0,2,0,1,3,3,3,3,3,3,1,0,2,0,0,
								 0,0,2,0,3,3,3,3,3,3,3,3,0,2,0,0,
								 0,0,2,2,3,2,1,2,2,1,2,3,2,2,0,0,
								 0,0,2,2,3,2,3,2,2,3,2,3,2,2,0,0,
								 0,0,0,2,2,2,2,2,2,2,2,2,2,3,0,0,
								 0,0,0,0,1,2,2,3,3,2,2,1,3,3,0,0,
								 0,0,3,3,3,3,3,2,2,2,1,1,1,2,0,0,
								 0,3,3,2,3,3,3,3,1,1,1,1,1,2,0,0,
								 0,3,2,2,2,3,3,2,3,3,1,1,3,0,0,0,
								 0,3,3,2,3,3,3,2,1,3,3,3,1,0,0,0,
								 0,3,3,2,3,3,3,2,3,3,1,1,1,0,0,0,
								 0,3,3,3,3,3,3,2,1,1,1,3,0,0,0,0,
								 0,0,2,2,2,2,2,0,0,3,3,3,0,0,0,0,
								 0,0,0,0,0,0,0,0,0,3,3,3,0,0,0,0]],
		walk_up: [[  0,0,0,0,0,1,1,1,1,1,1,0,0,0,0,0,
							   0,0,0,0,1,1,1,1,1,1,1,1,0,0,0,0,
							   0,0,2,0,1,1,1,1,1,1,1,1,0,2,0,0,
							   0,0,2,1,1,1,1,1,1,1,1,1,1,2,0,0,
							   0,0,2,3,1,1,1,1,1,1,1,1,3,2,0,0,
							   0,0,2,2,3,3,1,1,1,1,3,3,2,2,0,0,
							   0,0,0,2,3,3,3,1,1,3,3,3,2,0,0,0,
							   0,0,0,3,1,3,3,3,3,3,3,1,3,0,0,0,
							   0,0,3,3,1,1,1,1,1,1,1,3,3,0,0,0,
							   0,0,3,3,1,1,1,1,1,1,1,3,3,2,0,0,
							   0,0,0,3,3,1,1,1,1,1,1,3,3,2,0,0,
							   0,0,0,1,1,3,3,3,3,3,3,1,2,2,0,0,
							   0,0,0,1,1,1,1,1,1,1,1,1,1,0,0,0,
							   0,0,0,3,3,3,1,1,1,1,1,3,0,0,0,0,
							   0,0,0,3,3,3,3,0,0,3,3,0,0,0,0,0,
							   0,0,0,0,3,3,0,0,0,0,0,0,0,0,0,0],
							[  0,0,0,0,0,1,1,1,1,1,1,0,0,0,0,0,
							   0,0,0,0,1,1,1,1,1,1,1,1,0,0,0,0,
							   0,0,2,0,1,1,1,1,1,1,1,1,0,2,0,0,
							   0,0,2,1,1,1,1,1,1,1,1,1,1,2,0,0,
							   0,0,2,3,1,1,1,1,1,1,1,1,3,2,0,0,
							   0,0,2,2,3,3,1,1,1,1,3,3,2,2,0,0,
							   0,0,0,2,3,3,3,1,1,3,3,3,2,0,0,0,
							   0,0,0,3,1,3,3,3,3,3,3,1,3,0,0,0,
							   0,0,0,3,3,1,1,1,1,1,1,1,3,3,0,0,
							   0,0,2,3,3,1,1,1,1,1,1,1,3,3,0,0,
							   0,0,2,3,3,1,1,1,1,1,1,3,3,0,0,0,
							   0,0,2,2,1,3,3,3,3,3,3,1,1,0,0,0,
							   0,0,0,1,1,1,1,1,1,1,1,1,1,0,0,0,
							   0,0,0,0,3,1,1,1,1,1,3,3,3,0,0,0,
							   0,0,0,0,0,3,3,0,0,3,3,3,3,0,0,0,
							   0,0,0,0,0,0,0,0,0,0,3,3,0,0,0,0
							]],
		walk_right: [[
								 0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,
								 0,0,0,1,1,1,1,1,3,3,3,3,0,0,0,0,
								 0,1,1,1,2,1,1,3,3,3,3,3,3,0,0,0,
								 1,1,1,1,2,2,3,3,3,3,3,3,0,0,0,0,
								 1,0,1,1,2,2,2,3,2,2,1,2,0,0,3,0,
								 0,0,1,3,3,2,2,3,2,2,3,2,2,2,3,0,
								 0,0,0,3,3,3,2,2,2,2,2,2,0,0,3,0,
								 0,0,0,0,1,1,1,1,2,2,2,2,0,0,3,0,
								 0,0,3,1,1,1,1,1,1,1,3,3,3,1,3,0,
								 0,3,3,3,1,2,2,2,1,1,1,3,3,2,3,0,
								 0,3,3,3,3,2,2,2,1,1,1,3,3,0,3,0,
								 0,3,3,3,3,2,2,1,1,1,3,0,0,0,3,0,
								 0,0,1,3,3,1,1,3,3,3,3,0,0,0,3,0,
								 0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,
								 0,0,0,0,3,3,3,3,0,0,0,0,0,0,0,0,
								 0,0,0,0,3,3,3,3,3,0,0,0,0,0,0,0],
								[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
								 0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,
								 0,0,0,1,1,1,1,1,3,3,3,3,0,0,0,0,
								 0,1,1,1,2,1,1,3,3,3,3,3,3,0,0,0,
								 1,1,1,1,2,2,3,3,3,3,3,3,0,0,0,0,
								 1,0,1,1,2,2,2,3,2,2,1,2,0,0,0,0,
								 0,0,1,3,3,2,2,3,2,2,3,2,2,2,0,0,
								 0,0,0,3,3,3,2,2,2,2,2,2,0,3,0,0,
								 0,0,0,0,1,1,1,1,2,2,2,2,0,3,0,0,
								 0,0,1,3,3,1,1,2,2,2,3,3,2,3,0,0,
								 0,0,3,3,3,3,3,2,2,2,1,3,2,3,0,0,
								 0,1,3,3,3,3,3,2,2,1,1,3,0,3,0,0,
								 0,1,1,3,3,3,3,1,1,1,3,0,0,3,0,0,
								 3,3,1,1,1,1,1,3,3,3,3,1,0,3,0,0,
								 3,3,3,1,1,1,1,1,1,1,1,3,3,0,0,0,
								 0,3,3,3,0,0,0,0,0,3,3,3,0,0,0,0
							]]
	}
}

flip_horizontal = frame => {
	let reversedFrame = []
	for(let i=0; i<16; i++) reversedFrame.push(...frame.slice(i*16,i*16+16).reverse())
	return reversedFrame
}
animate_object = (ctx, cords, frames, colors, timing, reverse) => {
	let frame = 0
	const id = setInterval(() => {
		ctx.clearRect(cords.x, cords.y,128,128)
		draw_object(ctx, cords, frames[frame], colors, reverse)
		frame++
		if(frame > frames.length - 1) frame = 0
		console.log(frame)
	}, timing)
	return id
}
draw_object = (ctx,cords,frame,colors,reverse) => {
	if(reverse) frame = flip_horizontal(frame)
	for(let i=0; i<16; i++)
		for(let j=0; j<16; j++) {
			if(frame[i*16+j] !== 0) {
				ctx.fillStyle = colors[frame[i*16+j] - 1]
				ctx.fillRect(cords.x+j*8,cords.y+i*8,8,8)
			}
		}
}
animate_object(ctx, link.cords, link.frames.walk_right, link.colors, 1000, true)